<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ows4R">
<title>Use ows4R with OGC WCS (Web Coverage Service) • ows4R</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use ows4R with OGC WCS (Web Coverage Service)">
<meta property="og:description" content="ows4R">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ows4R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/csw.html">Use ows4R with OGC CSW (Catalogue Service for the Web)</a>
    <a class="dropdown-item" href="../articles/wcs.html">Use ows4R with OGC WCS (Web Coverage Service)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eblondel/ows4R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Use ows4R with OGC WCS (Web Coverage Service)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eblondel/ows4R/blob/HEAD/vignettes/wcs.Rmd" class="external-link"><code>vignettes/wcs.Rmd</code></a></small>
      <div class="d-none name"><code>wcs.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to use <a href="https://github.com/eblondel/ows4R" class="external-link">ows4R</a> with a Web Coverage
Service (OGC WCS).</p>
<p>An overview of the Web Coverage Service (WCS) can be found on the
official OGC webpage: <a href="https://www.ogc.org/standard/wcs/" class="external-link uri">https://www.ogc.org/standard/wcs/</a></p>
<p><a name="wcs-client"></a></p>
<div class="section level3">
<h3 id="create-wcs-client">Create WCS Client<a class="anchor" aria-label="anchor" href="#create-wcs-client"></a>
</h3>
<p>In order to operate on a Web Coverage Service, you need to create an
interface in R to this WCS. This is done with the class
<code>WCSClient</code>, as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WCS</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/WCSClient.html">WCSClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://ows.rasdaman.org/rasdaman/ows"</span>, <span class="st">"2.1.0"</span>, logger <span class="op">=</span> <span class="st">"INFO"</span><span class="op">)</span></span></code></pre></div>
<p>You can define the level of logger: “INFO” to get ows4R logs, “DEBUG”
for all internal logs (such as as Curl details). It is also possible to
define a username and password (<code>user</code> and <code>pwd</code>
parameters) in case operations would require an authentication to use
the Web Coverage Service.</p>
<p>Note: It is also possible to connect ot a WCS by means of a Central
Authentication System (CAS) with the <a href="https://github.com/eblondel/ows4R" class="external-link">ows4R</a>
<code>CASClient</code>. To do so, you can pass the CAS URL by means of
the <code>cas_url</code> argument.</p>
</div>
<div class="section level3">
<h3 id="get-capabilities-getcapabilities">Get Capabilities (<code>GetCapabilities</code>)<a class="anchor" aria-label="anchor" href="#get-capabilities-getcapabilities"></a>
</h3>
<p>When create the <code>WCSClient</code>, <code>ows4R</code> will run a
<code>GetCapabilities</code> request. To access the WCS Capabilities and
its sections, you can use the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caps</span> <span class="op">&lt;-</span> <span class="va">WCS</span><span class="op">$</span><span class="fu">getCapabilities</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-coverage-summaries">Get coverage summaries<a class="anchor" aria-label="anchor" href="#get-coverage-summaries"></a>
</h3>
<p>From the capabilities, it is possible to get all coverage summaries
by doing <code>caps$getCoverageSummaries()</code>. This method will
return a list of objects of class <code>WCSCoverageSummary</code>.</p>
<p>To get/find a specific coverage summary by name, you can run the
following method:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chla</span> <span class="op">&lt;-</span> <span class="va">caps</span><span class="op">$</span><span class="fu">findCoverageSummaryById</span><span class="op">(</span><span class="st">"AverageChloroColorScaled"</span>, exact <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="describe-a-coverage-describecoverage">Describe a coverage (<code>DescribeCoverage</code>)<a class="anchor" aria-label="anchor" href="#describe-a-coverage-describecoverage"></a>
</h3>
<p>The description of coverage can be fetched either from a coverage
summary or directly from the WCS client. When invoked the first time, an
OGC WCS <code>DescribeCoverage</code> request will be done.</p>
<ul>
<li><em>Get description from a coverage summary</em></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chla_des</span> <span class="op">&lt;-</span> <span class="va">chla</span><span class="op">$</span><span class="fu">getDescription</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><em>Get description from the WCS client</em></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chla_des</span> <span class="op">&lt;-</span> <span class="va">WCS</span><span class="op">$</span><span class="fu">describeCoverage</span><span class="op">(</span><span class="st">"AverageChloroColorScaled"</span><span class="op">)</span></span></code></pre></div>
<p>A coverage description corresponds to an exhaustive metadata set
describing the coverage characteristics such as the coverage limits in
space and time. It is represented by an object of class
<code>WCSCoverageDescription</code> including core GML metadata
properties usable in R thanks to <a href="https://github.com/eblondel/geometa" class="external-link">geometa</a>.</p>
<ul>
<li><em>Get list of coverage dimensions</em></li>
</ul>
<p>Associated with the coverage description, <a href="https://github.com/eblondel/ows4R" class="external-link">ows4R</a> defined a convenient
method to list the dimensions of the coverage:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chla_dims</span> <span class="op">&lt;-</span> <span class="va">chla</span><span class="op">$</span><span class="fu">getDimensions</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This method is particularly useful for spatio-temporal coverage,
allowing to retrieve the temporal extent (with time instants available
for the given coverage). In the present example, the coverage is
available for download for a certain number of time instants:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chla_time_instants</span> <span class="op">&lt;-</span> <span class="va">chla_dims</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-coverage-data-getcoverage">Get coverage data (<code>GetCoverage</code>)<a class="anchor" aria-label="anchor" href="#get-coverage-data-getcoverage"></a>
</h3>
<ul>
<li><em>Get single coverage</em></li>
</ul>
<p>Having a coverage well-described and its dimensions well-known, it’s
then possible to get the coverage data. Similarly to the coverage
description, coverage data can be get either from the coverage summary,
or directly through the WCS Client (specifying the coverage name as
first argument). Note however that because getting data from the WCS,
data is not DIRECTLY accessed into R through the web-service, data has
to be downloaded as temporary file within the R session temp directory.
This is done transparently by ows4R, without any action required by
user.</p>
<p>The below examples show how to get coverage from the coverage summary
object.</p>
<p>It is then possible to limit the spatial (or spatial-temporal) extent
by doing:</p>
<ul>
<li>
<em>slicing</em>: to specify a single value for a specific
dimension, eg. elevation, time</li>
<li>
<em>trimming</em>: to specify min-max values range for a specific
dimension, eg. lon/lat</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_data</span> <span class="op">&lt;-</span> <span class="va">chla</span><span class="op">$</span><span class="fu">getCoverage</span><span class="op">(</span></span>
<span>  bbox <span class="op">=</span> <span class="va">OWSUtils</span><span class="op">$</span><span class="fu">toBBOX</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">9</span>, <span class="fl">40</span>, <span class="fl">42</span><span class="op">)</span>, </span>
<span>  time <span class="op">=</span> <span class="va">chla_dims</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The result of the <code>getCoverage</code> method will be an object
of class <code>SpatRaster</code> from <a href="https://cran.r-project.org/package=terra" class="external-link">terra</a> package.</p>
<ul>
<li><em>Get stack of coverages</em></li>
</ul>
<p><a href="https://github.com/eblondel/ows4R" class="external-link">ows4R</a> extends on the
WCS standard and allows users to download a coverage stack by means of
the extra <code>getCoverageStack</code> method (only available from a
coverage summary object). The below code shows to download a timeseries
of coverages for the latest five time instants available:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_stack</span> <span class="op">&lt;-</span> <span class="va">chla</span><span class="op">$</span><span class="fu">getCoverageStack</span><span class="op">(</span></span>
<span>  bbox <span class="op">=</span> <span class="va">OWSUtils</span><span class="op">$</span><span class="fu">toBBOX</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">9</span>, <span class="fl">40</span>, <span class="fl">42</span><span class="op">)</span>, </span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">chla_dims</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coefficients</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="download-coverage-data-files">Download coverage data files<a class="anchor" aria-label="anchor" href="#download-coverage-data-files"></a>
</h3>
<p>The above methods described allow to read coverage data within R with
<a href="https://cran.r-project.org/package=terra" class="external-link">terra</a> package
without persisting data in specific files named by user, but as
temporary file within the R session temp directory. However it is
sometimes required or wished to download coverage data files on the file
system. <a href="https://github.com/eblondel/ows4R" class="external-link">ows4R</a> allows to
download coverage data files both in <code>getCoverage</code> and
<code>getCoverageStack</code>.</p>
<ul>
<li><em>for a single coverage</em></li>
</ul>
<p>The <code>getCoverage</code> method provides a <code>filename</code>
argument that can be used to download the data files:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_data</span> <span class="op">&lt;-</span> <span class="va">chla</span><span class="op">$</span><span class="fu">getCoverage</span><span class="op">(</span></span>
<span>  bbox <span class="op">=</span> <span class="va">OWSUtils</span><span class="op">$</span><span class="fu">toBBOX</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">9</span>, <span class="fl">40</span>, <span class="fl">42</span><span class="op">)</span>, </span>
<span>  time <span class="op">=</span> <span class="va">chla_dims</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">"myfile.tif"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li><em>from a coverage stack</em></li>
</ul>
<p>To download data files for a coverage stack, it is required to
provide a function, handled with the argument
<code>filename_handler</code> that will set for each coverage the target
file name. Such function should have a set of mandatory arguments,
namely: <code>identifier</code> (coverage identifier), <code>time</code>
(time filter), <code>elevation</code> (elevation filter),
<code>bbox</code> (bbox filter), <code>format</code> (target format);
The output of this function will be filename to be used for the given
coverage. To simplify the download <a href="https://github.com/eblondel/ows4R" class="external-link">ows4R</a> puts at disposal a
ready-to-use filename handler named
<code>WCSCoverageFilenameHandler</code> that is enough to add to trigger
the data files download.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_stack</span> <span class="op">&lt;-</span> <span class="va">chla</span><span class="op">$</span><span class="fu">getCoverageStack</span><span class="op">(</span></span>
<span>  bbox <span class="op">=</span> <span class="va">OWSUtils</span><span class="op">$</span><span class="fu">toBBOX</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">9</span>, <span class="fl">40</span>, <span class="fl">42</span><span class="op">)</span>, </span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">chla_dims</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coefficients</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  filename_handler <span class="op">=</span> <span class="va">WCSCoverageFilenameHandler</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-data-get-from-wcs-getcoverage-vs--wms-getfeatureinfo">Comparing data get from WCS (<code>GetCoverage</code>) vs. WMS
(<code>GetFeatureInfo</code>)<a class="anchor" aria-label="anchor" href="#comparing-data-get-from-wcs-getcoverage-vs--wms-getfeatureinfo"></a>
</h3>
<p>As matter of quality assurance, it is possible to compare raster data
values get using the WCS/Getcoverage with the data values get from a
WMS/GetFeatureInfo operation (emulating a map click). The below example
illustrates this check:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Get data using WCS</span></span>
<span><span class="va">vliz</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/WCSClient.html">WCSClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://geo.vliz.be/geoserver/wcs"</span>, serviceVersion <span class="op">=</span> <span class="st">"2.0.1"</span>, logger <span class="op">=</span> <span class="st">"DEBUG"</span><span class="op">)</span></span>
<span><span class="va">cov</span> <span class="op">&lt;-</span> <span class="va">vliz</span><span class="op">$</span><span class="fu">getCapabilities</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">findCoverageSummaryById</span><span class="op">(</span><span class="st">"Emodnetbio__aca_spp_19582016_L1"</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">cov_des</span> <span class="op">&lt;-</span> <span class="va">cov</span><span class="op">$</span><span class="fu">getDescription</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cov_data</span> <span class="op">&lt;-</span> <span class="va">cov</span><span class="op">$</span><span class="fu">getCoverage</span><span class="op">(</span></span>
<span>  bbox <span class="op">=</span> <span class="va">OWSUtils</span><span class="op">$</span><span class="fu">toBBOX</span><span class="op">(</span><span class="fl">8.37</span>,<span class="fl">8.41</span>,<span class="fl">58.18</span>,<span class="fl">58.24</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="va">cov</span><span class="op">$</span><span class="fu">getDimensions</span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cov_data_stack</span> <span class="op">&lt;-</span> <span class="va">cov</span><span class="op">$</span><span class="fu">getCoverageStack</span><span class="op">(</span></span>
<span>  bbox <span class="op">=</span> <span class="va">OWSUtils</span><span class="op">$</span><span class="fu">toBBOX</span><span class="op">(</span><span class="fl">8.37</span>,<span class="fl">8.41</span>,<span class="fl">58.18</span>,<span class="fl">58.24</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="va">cov</span><span class="op">$</span><span class="fu">getDimensions</span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/compareGeom.html" class="external-link">compareGeom</a></span><span class="op">(</span><span class="va">cov_data</span>,<span class="va">cov_data_stack</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co">#compare with data returned by WMS GetFeatureInfo</span></span>
<span><span class="va">vliz_wms</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/WMSClient.html">WMSClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://geo.vliz.be/geoserver/wms"</span>, service <span class="op">=</span> <span class="st">"1.1.1"</span>, logger <span class="op">=</span> <span class="st">"DEBUG"</span><span class="op">)</span></span>
<span><span class="va">gfi</span> <span class="op">&lt;-</span> <span class="va">vliz_wms</span><span class="op">$</span><span class="fu">getFeatureInfo</span><span class="op">(</span></span>
<span>  layer <span class="op">=</span> <span class="st">"Emodnetbio:aca_spp_19582016_L1"</span>, feature_count <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  x <span class="op">=</span> <span class="fl">50</span>, y <span class="op">=</span> <span class="fl">50</span>, srs <span class="op">=</span> <span class="st">"EPSG:4326"</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">101</span>, height <span class="op">=</span> <span class="fl">101</span>, </span>
<span>  bbox <span class="op">=</span> <span class="va">OWSUtils</span><span class="op">$</span><span class="fu">toBBOX</span><span class="op">(</span><span class="fl">8.12713623046875</span>,<span class="fl">8.68194580078125</span>,<span class="fl">57.92266845703125</span>,<span class="fl">58.47747802734375</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#final check</span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">cov_data</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">gfi</span><span class="op">$</span><span class="va">relative_abundance</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Emmanuel Blondel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
